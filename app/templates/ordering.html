{% extends "navbar.html" %}

{% block content %}
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<style>
    #sortable { list-style-type: none; margin: 0; padding: 0; width: 450px; }
    #sortable li { margin: 3px 3px 3px 0; padding: 1px; float: left; width: 100px; height: 90px; font-size: 4em; text-align: center; }
</style>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    $( function() {
      $( "#sortable" ).sortable();
      $( "#sortable" ).disableSelection();
    } );
</script>
<div>
    <div style="margin-top: 10px;display: grid;justify-content: center;max-width: none !important;">
        <div class="jumbotron my-auto" style="width: max-content; background-color: floralwhite;">
            <div class="container" style="max-width: none !important;"><!--
                <h2>PERO - Readability assessment annotator</h2>
                <p> Order images from the most readable to the least readable.</p>-->
                <form action = "{{ request.path }}" method = "post">
                    <input id="1" style="margin-top: -10px; margin-bottom: 7px;" value="Done" name="submit_button" type="submit" class="btn btn-secondary"/>
                    <input id="hour" value="00" name = "hour" type = "text" style="display: none;"/>
                    <input id="min" value="00" name = "min" type = "text" style="display: none;"/>
                    <input id="sec" value="00" name = "sec" type = "text" style="display: none;"/>
                    <input id="milisec" value="00" name = "milisec" type = "text" style="display: none;"/>
                    <input value="{{record_id}}" name = "record" type = "text" style="display: none;"/>
                    <input id="order" value="" name = "order" type = "text" style="display: none;"/>
                </form>
                <div style="display: flex;  margin-bottom: 10px;width: max-content;" id="sortable">

                {% for image_for_annotation in images_for_annotation %}
                    <div id="{{image_for_annotation[0]}}"  style="display: grid; margin-right: 10px">
                        <img  type="image"  class="img-rounded" style="width: 341px;border-radius: 6px;" src="{{ url_for('send_file', filename=image_for_annotation[1]) }}" alt="Image for annotation"/>
                    </div>
                {% endfor %}

                <!--
                <div style="margin-top: 13px;">
                    <a href="/" style="color:inherit;text-decoration: none;">  
                        <button type="button" class="btn btn-secondary">Change mode</button>
                    </a>
                    <button type="button" class="btn btn-secondary">Change set</button>
                    <button type="button" class="btn btn-secondary">Previous tuple</button>
                    <button type="button" class="btn btn-secondary">Next tuple</button>
                </div>-->

            </div>
        </div>
    </div>
</div>
<script>
    var x;

    start();

    function start() {
      x = setInterval(timer, 10);
    }

    function stop() {
      clearInterval(x);
    }

    var milisec = 0;
    var sec = 0; /* holds incrementing value */
    var min = 0;
    var hour = 0;

    var miliSecOut = 0;
    var secOut = 0;
    var minOut = 0;
    var hourOut = 0;

    function timer() {
      miliSecOut = checkTime(milisec);
      secOut = checkTime(sec);
      minOut = checkTime(min);
      hourOut = checkTime(hour);

      milisec = ++milisec;

      if (milisec === 100) {
        milisec = 0;
        sec = ++sec;
      }

      if (sec == 60) {
        min = ++min;
        sec = 0;
      }

      if (min == 60) {
        min = 0;
        hour = ++hour;

      }

      document.getElementById("milisec").value = miliSecOut;
      document.getElementById("sec").value = secOut;
      document.getElementById("min").value = minOut;
      document.getElementById("hour").value = hourOut;
    }

    function checkTime(i) {
      if (i < 10) {
        i = "0" + i;
      }
      return i;
    }
</script>
<script type="text/javascript">
    function order() {
    var div = document.getElementById("sortable")// getElementById, etc
    var children = div.childNodes;
    var elements = [];
    for (var i=0; i<div.childNodes.length; i++) {
      var child = div.childNodes[i];
      if (child.nodeType == 1) {
        elements.push(child)      
      }
    }
    string=""
    for (var i=0; i<elements.length; i++) {
        string+=elements[i].id.toString();
        }

    document.getElementById("order").value = string;}

    setInterval(order, 5);
</script>
<script>
function capture(e){
    var evt = e || window.event; 
    if(evt.keyCode==13){
        document.getElementById('1').click();
        }
    }
document.onkeyup=capture
</script>
{% endblock %}
